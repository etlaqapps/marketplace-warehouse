# Private Multi-Warehouse Fulfillment Operating System: WMS/OMS Solution for 3PL Operations

This platform operates as a comprehensive fulfillment operating system: a **core WMS/OMS foundation** handles warehouse management, order fulfillment, merchant operations, and billing. Domain modules extend it with specialized 3PL capabilities, integrating via shared backend and frontend routing—enabling phased builds, multi-warehouse scaling (10+ facilities, 100,000+ SKUs), and operational resilience (ASN tracking, QC workflows, automated routing). Users interact via role-tailored, responsive web/mobile dashboards, with automations for workflows like ASN receiving, wave picking, FEFO compliance, and real-time billing reconciliation.

## Base Enterprise App

Universal starter: Landing page for discovery; authentication (email/phone OTP, approvals); RBAC (roles/permissions, scoping); analytics (KPIs, oversight); payments (balance top-ups, gateway payouts)

## Core Plugins (Domain-Specific Extensions)

1. **Store & Product Management**: CRUD for stores/products (uploads, bulk CSV, approvals); validations, inventory views. Syncs to listings.
2. **Warehouse Core**: ASN/PO receiving, QC on receiving, system-suggested put-away, cycle counting, bin capacity tracking, multi-warehouse support.
3. **Fulfillment Operations**: Wave & batch picking, scan-to-pick/pack enforcement, route optimization, packing validation, fulfillment status tracking.
4. **Compliance Tracking**: FEFO, batch/lot tracking, expiry management, recall workflows, QC policies.
5. **Merchant Portal**: Order visibility, inventory reports, performance analytics, billing dashboards, real-time tracking.
6. **Logistics Management**: API pickups (balance-gated); auto-routing, labels, tracking; manual fallbacks. Bulk scheduling.
7. **Multi-Invoice & Billing**: Per-order splits (multi-party); VAT by category; accounting push; cycles/automations. Bulk gen.
8. **Marketplace Management**: Listing sync (multi-API); order aggregation; manual entry. De-dupes.
9. **Payout & Payment Handling**: Prepay top-ups; cycle payouts (multi-bank); balance enforcement. Audits.
10. **Returns & Refunds**: RMA creation/authorization; restocking; refunds. Lifecycle reversal.
11. **Audit & Logging**: Full transaction/API logs; retention/exports. Compliance trails.
12. **SLAs Enforcement & Monitoring**

## Base System (Foundation).

### Feature 1 — Landing Page

| ID    | Use Case          | User Story                                                                                                                            | Acceptance Criteria                                                                                                                                                                                                                                                                                                    |
| ----- | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC1.1 | Platform Overview | As a potential user, I want to view a landing page with platform information so that I can learn about the app and decide to sign up. | Given a visitor accesses the landing page<br>When they browse sections (hero, features, CTA)<br>Then feature overviews are displayed, and "Sign Up" button redirects to signup screen.<br>Edge: Mobile view → responsive stacking of cards.<br>Error: Page load failure → show fallback static text with retry button. |

### Feature 2 — Authentication

| ID    | Use Case                 | User Story                                                                                                                               | Acceptance Criteria                                                                                                                                                                                                                                                                                                             |
| ----- | ------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC2.1 | Signup Basic Info        | As a new user, I want to enter basic details (email, phone, password, license/document) so that I can start creating an account.         | Given a new user on signup step 1<br>When they submit valid details and upload document<br>Then form validates in real-time, and proceeds to OTP verification.<br>Edge: Missing fields → disabled "Next" button with highlighted errors.<br>Error: Duplicate email/phone → inline error "Already registered? Log in" with link. |
| UC2.2 | OTP Verification         | As a new user, I want to verify email or phone via OTP so that my contact details are confirmed securely.                                | Given OTP sent during signup<br>When user enters correct 6-digit OTP (tabs for email/phone)<br>Then verification succeeds, proceeds to profile completion.<br>Edge: Resend OTP → new code sent after 60s cooldown.<br>Error: Invalid OTP (3 attempts) → lockout modal "Too many attempts. Wait 5 mins." with shake animation.   |
| UC2.3 | Profile Completion       | As a new user, I want to complete my profile (name, business type, address, avatar) so that my account is fully set up pending approval. | Given OTP verified<br>When user submits valid profile details<br>Then account is created, success modal shown, and admin notified for approval.<br>Edge: Optional fields skipped → no error, but reminder toast.<br>Error: Invalid data (e.g., short name) → error list at top, scroll to first issue.                          |
| UC2.4 | Post-Signup Confirmation | As a new user, I want a confirmation after signup so that I know the status and next steps.                                              | Given profile submitted<br>When modal/page loads<br>Then displays "Account pending approval" with links to login/home.<br>Edge: Email notification sent → confirm in logs (system).<br>Error: None (static page).                                                                                                               |
| UC2.5 | Login                    | As an existing user, I want to log in with email/phone and password so that I can access my dashboard securely.                          | Given a registered user on login screen<br>When correct credentials entered<br>Then user is authenticated and redirected to role-based dashboard.<br>Edge: "Forgot Password?" link → opens recovery modal.<br>Error: Invalid credentials (3 attempts) → show CAPTCHA and temporary lockout.                                     |
| UC2.6 | Password Recovery        | As an existing user, I want to recover my password via OTP so that I can regain access if forgotten.                                     | Given "Forgot Password" clicked<br>When email/phone submitted, OTP verified, new password set<br>Then password is reset, success message shown, and redirect to login.<br>Edge: Step indicators for multi-step process.<br>Error: Invalid email/phone → "Not found" error; OTP fail → resend option.                            |

### Feature 3 — Authorization (RBAC)

| ID    | Use Case                     | User Story                                                                                                               | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                               |
| ----- | ---------------------------- | ------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC3.1 | Role-Based Dashboard Routing | As a user, I want automatic routing to my role-specific dashboard upon login so that I see relevant content immediately. | Given user logs in with a role<br>When URL/path and role checked<br>Then redirected to appropriate dashboard (e.g., user vs. admin).<br>Edge: Multi-role user → header dropdown to switch roles, confirms and reloads.<br>Error: Invalid/unauthorized role → 403 error page "Contact Admin" with logout.                                                                          |
| UC3.2 | Define Roles                 | As an Admin, I want to create, edit, or delete roles with permissions so that access control reflects business needs.    | Given admin on "Define Roles" tab<br>When they create/edit a role (name, description, inheritance, permissions matrix)<br>Then role is persisted, list refreshes, and success toast shown.<br>Edge: Inheritance selected → pre-fills permissions, overridable.<br>Error: Duplicate name → inline error "Name in use"; delete in use → modal "Unassign from users first."          |
| UC3.3 | Permission Granularity       | As an Admin, I want to set fine-grained permissions (entity/action level) so that least privilege is enforced.           | Given role creation/edit modal open<br>When permissions toggled (e.g., Read/Write for Analytics)<br>Then matrix updates, and on save, UI/API blocks unauthorized actions (403).<br>Edge: Constraint checkbox (e.g., one role per system) → adds scoping dropdown.<br>Error: Conflict with inheritance → warning banner "Overriding inherited permissions?"                        |
| UC3.4 | Assign Roles                 | As an Admin, I want to assign roles to users or teams with scoping so that access is limited appropriately.              | Given admin on "Assign Roles" tab<br>When users selected, role/scope chosen, and "Assign" clicked<br>Then assignments update, current roles column refreshes, toast "Assigned to X users."<br>Edge: Bulk select/unassign → confirm modal for changes.<br>Error: Constraint violation (e.g., one role per system) → toast "User already has role in this system - unassign first." |
| UC3.5 | Audit Role Changes           | As a system, I want to log role/permission changes and assignments so that admins can review security events.            | Given RBAC event occurs (create, assign, delete)<br>When event triggers<br>Then log entry stored with actor, timestamp, before/after state; visible in system analytics.<br>Edge: Export logs → CSV download.<br>Error: Log failure → alert admin via email (if notifications enabled).                                                                                           |
| UC3.6 | Strict Tenant Isolation      | As a System, I want enforced data silos per seller so that cross-tenant access is impossible.                            | Given RBAC query<br>When checks tenant ID<br>Then blocks/queries only within seller's scope, logs violations.<br>Edge: Shared resources (e.g., carriers) → anonymized views.<br>Error: Breach attempt → 403 + admin alert.                                                                                                                                                        |
| UC3.7 | Tenant Audit Isolation       | As an Admin, I want tenant-specific audits so that seller data remains isolated in logs.                                 | Given log export<br>When filters by tenant<br>Then exports only scoped data, masks others.<br>Edge: Global admin → opt-in cross-tenant.<br>Error: Unscoped export → block "Isolation violation."                                                                                                                                                                                  |

### Feature 4 — Analytics

| ID    | Use Case                 | User Story                                                                                                                    | Acceptance Criteria                                                                                                                                                                                                                                                          |
| ----- | ------------------------ | ----------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC4.1 | User Analytics Dashboard | As a non-admin user, I want to view basic KPIs (e.g., balance, activity) so that I can track my performance.                  | Given user on analytics section<br>When data loads<br>Then KPI cards/charts shown (e.g., balance chart, activity list) with refresh/export buttons.<br>Edge: No data → guidance message "Add payments to see stats."<br>Error: Load failure → retry button with error toast. |
| UC4.2 | Admin System Analytics   | As an Admin, I want full oversight analytics (multi-user KPIs, logs, alerts) so that I can monitor and resolve system issues. | Given admin on system analytics screen<br>When viewing data (charts, logs table)<br>Then all-user KPIs displayed, filters (user/role/date) applied, resolve button for errors.<br>Edge: Click log → details modal.<br>Error: Unauthorized access → 403 page.                 |

### Feature 5 — Basic Payment & Payout

| ID    | Use Case               | User Story                                                                                                    | Acceptance Criteria                                                                                                                                                                                                                                                                            |
| ----- | ---------------------- | ------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC5.1 | Balance Check & Top-Up | As a user, I want to view and top up my balance via Moyasar so that I can maintain funds for operations.      | Given user on payments section<br>When "Top Up" clicked, amount entered, Moyasar form submitted<br>Then payment processed, balance updated, success toast shown.<br>Edge: Low balance → warning banner "Top up to continue."<br>Error: Transaction rejected → error "Retry?" with log.         |
| UC5.2 | Payout Handling        | As a user (with permission), I want to initiate payouts via Moyasar so that I can withdraw funds on schedule. | Given payout cycle (e.g., manual trigger if allowed)<br>When amount/bank details entered in modal<br>Then payout scheduled/processed, logs updated.<br>Edge: Cycle info shown (e.g., next payout date).<br>Error: Insufficient balance → disabled button with tooltip; API fail → retry queue. |

### Feature 6 — Profile & Settings (Shared)

| ID    | Use Case           | User Story                                                                                                            | Acceptance Criteria                                                                                                                                                                            |
| ----- | ------------------ | --------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC6.1 | Profile Management | As a user, I want to view and edit my profile (name, email, phone, avatar, password) so that my details stay current. | Given user on profile screen<br>When edits saved<br>Then changes persisted, confirmation modal shown.<br>Edge: Pencil icons for edit mode.<br>Error: Invalid input → inline validation errors. |

### Feature 7 — Admin-Specific (User Approval & Oversight)

| ID    | Use Case               | User Story                                                                                            | Acceptance Criteria                                                                                                                                                                                                                          |
| ----- | ---------------------- | ----------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC7.1 | User Approval Queue    | As an Admin, I want to review and approve/reject new users so that only valid accounts are activated. | Given admin on approval queue screen<br>When approve/reject clicked (view documents in modal)<br>Then status updated, email sent to user.<br>Edge: No pendings → empty state message.<br>Error: Invalid document → reject with reason modal. |
| UC7.2 | Admin Dashboard Access | As an Admin, I want an enhanced dashboard with admin tools so that I can oversee the system.          | Given admin login<br>When dashboard loads<br>Then shows admin sidebar (e.g., User Management, Role Editor), overview KPIs.<br>Edge: Search bar for quick navigation.<br>Error: Non-admin access → hidden/403.                                |

### Feature 8 — General System Behaviors

| ID    | Use Case    | User Story                                                                                    | Acceptance Criteria                                                                                                                                                                                       |
| ----- | ----------- | --------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC8.1 | Logout      | As an authenticated user, I want to log out securely so that my session ends.                 | Given any authenticated screen<br>When logout clicked from profile icon<br>Then confirm modal shown, on yes redirects to landing page.<br>Edge: None.<br>Error: Session error → auto-logout with message. |
| UC8.2 | Error Pages | As a user, I want friendly error pages (404, 500, 403) so that issues are handled gracefully. | Given invalid access/load<br>When error occurs<br>Then shows appropriate page (e.g., 404: "Page not found" with home link).<br>Edge: None.<br>Error: None (fallback UI).                                  |

### Wireframes of the base system

<img width="2560" height="2752" alt="screen" src="https://github.com/user-attachments/assets/d46b79fe-e41f-4e26-b487-2143f208e8fc" />

<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/ea7900b7-40ef-42a7-bab7-c4b28ae2d97e" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/2cbeb1d4-caaf-46f8-9eda-683f50020014" />

<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/8f26045c-2da4-4b4c-a264-006794b21391" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/1a6ae1b0-4853-4ac1-8a47-a3fc1c36d2d4" />
<img width="2560" height="2378" alt="screen" src="https://github.com/user-attachments/assets/ecd304a7-4b8d-4435-adb5-d86738d7b5e8" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/b99e0ed7-cfad-4113-a676-424a72a35838" />
<img width="2560" height="1714" alt="screen" src="https://github.com/user-attachments/assets/928b308f-b6a0-43df-add5-e852efadfd17" />
<img width="2560" height="2174" alt="screen" src="https://github.com/user-attachments/assets/513dd022-3f50-4da8-a862-2702bdd3308c" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/7b5c27ba-20a3-4399-9560-b2649af69f60" />
<img width="2560" height="2084" alt="screen" src="https://github.com/user-attachments/assets/38a86e93-498d-4366-8300-2579176ffcee" />
<img width="2560" height="2214" alt="screen" src="https://github.com/user-attachments/assets/4622eaf4-9c03-43ce-ae06-d7a4d6d7970d" />

## Plugin 1 — Store & Product Management

| ID     | Use Case                      | User Story                                                                                                                                                                           | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------ | ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC1.1  | Store Registration Form       | As a Store Owner, I want to enter store details (name, food type, address, workers, license) so that my store can be onboarded and approved.                                         | Given Store Owner on registration screen<br>When valid details submitted (e.g., name, dropdown for food type, address textarea, workers number input, license upload)<br>Then form validates, store profile saved pending approval, admin notified.<br>Edge: Optional workers field skipped → no error, defaults to 0.<br>Error: Invalid data (e.g., missing name) → inline errors, disabled submit; duplicate store name → "Store name already exists" toast.               |
| UC1.2  | Store Approval Workflow       | As an Admin, I want to review and approve/reject store registrations so that only compliant stores are activated.                                                                    | Given pending store in approval queue<br>When admin views details (e.g., click row for modal with license preview)<br>Then approve activates store, sends email to owner; reject prompts reason modal, notifies owner.<br>Edge: No pendings → empty state "No stores awaiting approval."<br>Error: Invalid license (e.g., poor quality) → flag in modal, re-upload request sent to owner.                                                                                    |
| UC1.3  | Product Create/Upload Form    | As a Store Owner, I want to create/upload product details (basic info, images, stock, SKU) so that products can be submitted for approval and inventory management.                  | Given Store Owner on product create screen (post-store approval)<br>When details entered (name/text, images drag-drop/multiple, stock number, SKU text with uniqueness check)<br>Then validates (e.g., image size <5MB), saves pending approval, syncs to inventory queue.<br>Edge: Multiple images → thumbnail previews with reorder/delete.<br>Error: Bad data (e.g., negative stock) → validation error; upload fail → "File type not supported (JPEG/PNG only)" message. |
| UC1.4  | Product Approval Workflow     | As an Admin, I want to review and approve/reject new products so that only valid products are listed in inventory and marketplace.                                                   | Given pending product in queue<br>When admin reviews (modal with details, images carousel, stock/SKU info)<br>Then approve adds to live inventory, notifies owner; reject with reason, allows resubmit.<br>Edge: Bulk approve/reject → checkboxes for multiple selections.<br>Error: Duplicate SKU → auto-reject with "Duplicate detected" log.                                                                                                                              |
| UC1.5  | Product List & Read/View      | As a Store Owner, I want to list and view my products with search/filter/sort/export so that I can manage large inventories efficiently.                                             | Given Store Owner on products list screen<br>When searching (e.g., by name/SKU), filtering (e.g., by food type/low stock), sorting (e.g., by stock DESC)<br>Then displays paginated table (name, SKU, stock gauge, images thumbnail, actions), export button (CSV/PDF).<br>Edge: No products → empty state "No products yet - create one."<br>Error: Search fail (e.g., network) → retry button with warning.                                                                |
| UC1.6  | Product Update/Edit           | As a Store Owner, I want to edit existing product details (info, images, stock) so that I can update inventory without re-uploading.                                                 | Given Store Owner selects product from list<br>When edits in modal/form (update name, add/remove images, adjust stock)<br>Then saves changes, triggers re-approval if major (e.g., name change), syncs to inventory.<br>Edge: Minor edits (e.g., stock only) → no approval needed.<br>Error: Invalid update (e.g., duplicate SKU) → inline error; concurrent edit → version conflict modal "Refresh and try again."                                                          |
| UC1.7  | Product Delete                | As a Store Owner, I want to delete products (single or bulk) so that obsolete items are removed from inventory.                                                                      | Given Store Owner on list screen<br>When selects product(s), clicks delete (confirm modal)<br>Then removes from DB, notifies warehouse if stocked, logs action.<br>Edge: Bulk delete → checkboxes, confirm with count "Delete X products?"<br>Error: Product in active order → block with error "Cannot delete - in use."                                                                                                                                                    |
| UC1.8  | Bulk Product Upload/Import    | As a Store Owner, I want to bulk upload products via CSV so that I can add multiple items efficiently for enterprise-scale operations.                                               | Given Store Owner on bulk upload screen<br>When uploads CSV (template download link, columns: name, SKU, stock, food type, image URLs)<br>Then parses, validates rows, submits for batch approval, shows progress bar/report (e.g., "X succeeded, Y failed").<br>Edge: Partial success → list errors per row (e.g., "Row 5: Invalid stock").<br>Error: Invalid CSV format → error toast "Malformed file - download template."                                                |
| UC1.9  | Inventory Views & Updates     | As a Store Owner, I want to view inventory updates, stock levels, and KPIs so that I can track product status without manual checks.                                                 | Given Store Owner on dashboard/inventory section<br>When data loads (real-time sync from warehouse)<br>Then displays table/cards (product name, SKU, stock level, updates list with timestamps), KPIs (e.g., low stock count, sales velocity chart).<br>Edge: Filter by status (e.g., pending approval) → dynamic table update.<br>Error: Sync failure → retry button, fallback to last known data with warning banner.                                                      |
| UC1.10 | System Inventory Sync & Rules | As a system, I want to sync product CRUD actions to live inventory with rules (e.g., SKU mapping, low stock thresholds) so that warehouse and marketplace are updated automatically. | Given product CRUD event (create/update/delete/approve)<br>When sync triggers (background job)<br>Then updates inventory DB, applies rules (e.g., map SKU, flag low stock), notifies supervisor for shelf assignment, logs event.<br>Edge: Manual trigger by admin → override button in queue.<br>Error: Sync conflict (e.g., stock mismatch) → admin alert, rollback with error log.                                                                                        |

## Wireframes of Marketplace

<img width="2560" height="2612" alt="screen" src="https://github.com/user-attachments/assets/6bc63de2-d595-4592-82e7-86cd89d8fcea" />
<img width="2644" height="1600" alt="screen" src="https://github.com/user-attachments/assets/48f14b32-8d35-448a-ba6a-17072d4795ac" />

<img width="2560" height="2632" alt="screen" src="https://github.com/user-attachments/assets/e091c622-8412-4191-9b62-64718fca4c50" />
<img width="2560" height="1754" alt="screen" src="https://github.com/user-attachments/assets/df08b3c8-1a9c-4e1a-aab7-5a0a25b6284a" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/c4cb594f-29d5-43dd-823d-064d3da37896" />

## Plugin 2: Warehouse Management

| ID     | Use Case                         | User Story                                                                                                                                                   | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ------ | -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC2.1  | Staff Addition/Create Form       | As a Warehouse Owner, I want to add supervisors or workers (name, email/phone, role assignment) so that team members can be onboarded with role constraints. | Given Warehouse Owner on staff add screen<br>When valid details submitted (name text, email/phone, role dropdown: supervisor/worker)<br>Then validates (e.g., one role per system), adds user, sends invitation email, syncs to RBAC.<br>Edge: Role constraint check → warning if violates (e.g., user already has role in another system).<br>Error: Duplicate email → "User exists - assign existing?" link; invalid data → inline errors, disabled submit. |
| UC2.2  | Staff List & Read/View           | As a Warehouse Owner, I want to list and view staff with search/filter/sort/export so that I can manage large teams efficiently.                             | Given Warehouse Owner on staff list screen<br>When searching (e.g., by name/email), filtering (e.g., by role/active), sorting (e.g., by join date)<br>Then displays paginated table (name, role badge, email/phone, status, actions), export button (CSV/PDF).<br>Edge: No staff → empty state "No team members - add one."<br>Error: Load failure → retry button with warning.                                                                               |
| UC2.3  | Staff Update/Edit                | As a Warehouse Owner, I want to edit staff details (e.g., role switch, contact) so that changes can be made without re-adding.                               | Given Warehouse Owner selects staff from list<br>When edits in modal/form (update name, role with constraint check)<br>Then saves, notifies user if role changes, syncs to RBAC.<br>Edge: Role switch → confirm modal if affects access.<br>Error: Constraint violation → error "Cannot assign - violates one role per system"; concurrent edit → version conflict "Refresh."                                                                                 |
| UC2.4  | Staff Delete                     | As a Warehouse Owner, I want to delete staff (single or bulk) so that inactive members are removed.                                                          | Given Warehouse Owner on list screen<br>When selects staff(s), clicks delete (confirm modal)<br>Then removes from DB, revokes access, logs action.<br>Edge: Bulk delete → checkboxes, confirm with count "Delete X staff?"<br>Error: Active assignments (e.g., pending tasks) → block "Cannot delete - reassign tasks first."                                                                                                                                 |
| UC2.5  | Bulk Staff Addition/Import       | As a Warehouse Owner, I want to bulk add staff via CSV so that large teams can be onboarded efficiently.                                                     | Given Warehouse Owner on bulk add screen<br>When uploads CSV (template download, columns: name, email, role)<br>Then parses, validates rows, adds batch, shows report (e.g., "X added, Y failed").<br>Edge: Partial success → error list per row (e.g., "Row 3: Invalid email").<br>Error: Invalid format → "Malformed CSV - download template."                                                                                                              |
| UC2.6  | Shelf Assignment (Manual/Auto)   | As a Supervisor, I want to assign shelves to products on arrival (manual or auto) so that storage is optimized.                                              | Given Supervisor on assignment screen (triggered by arrival)<br>When selects product, assigns shelf (dropdown or map click; auto-suggest toggle)<br>Then saves location, updates inventory, notifies worker for placement.<br>Edge: Auto mode → suggests based on rules (e.g., food type/size; future AI).<br>Error: Shelf full → error "Select another - capacity exceeded"; no shelves → "Add shelves first."                                               |
| UC2.7  | QR Mapping for Store/Pick        | As a Worker, I want to use QR map to store or pick products so that locations are accurately logged.                                                         | Given Worker on mobile/web map screen (scan or search product)<br>When scans QR/shelf, confirms action (store/pick)<br>Then logs movement, updates stock/location in real-time, shows success.<br>Edge: Map UI → interactive floorplan with zoom/pan, highlighted paths.<br>Error: Wrong QR → shake/vibrate "Invalid shelf - rescan"; offline → queue for sync.                                                                                               |
| UC2.8  | Inventory Management List & View | As a Supervisor, I want to view and manage live inventory with search/filter/sort/export so that I can oversee stock efficiently.                            | Given Supervisor on inventory screen<br>When searching (e.g., by product/SKU), filtering (e.g., low stock/shelf), sorting (e.g., by expiry)<br>Then displays table (product, shelf location link, stock, status, actions), export.<br>Edge: Integrate with map → click location → zooms to shelf.<br>Error: Sync delay → warning banner "Data may be stale - refresh."                                                                                        |
| UC2.9  | Warehouse Order Creation         | As a Supervisor, I want to create warehouse orders from arrivals/marketplace so that picking/packing can begin.                                              | Given arrival/order received<br>When creates order (select products, assign to worker)<br>Then generates order ID, updates status (Pending → Assigned), notifies worker.<br>Edge: Bulk from batch arrival → auto-populate.<br>Error: Insufficient stock → block "Adjust quantities."                                                                                                                                                                          |
| UC2.10 | Picking & Packing Workflow       | As a Worker, I want to pick and pack orders using QR validation so that fulfillment is accurate.                                                             | Given Worker on order screen<br>When scans product/shelf for pick, confirms pack (quantity check)<br>Then validates (e.g., packing-validation), updates status to Packed, logs.<br>Edge: Partial pick → save progress.<br>Error: Wrong item → error "Mismatch - rescan correct product."                                                                                                                                                                      |
| UC2.11 | System Inventory Sync & Tracking | As a system, I want to sync inventory movements (assignments, picks) with shelf tracking so that real-time accuracy is maintained.                           | Given movement event (assign/store/pick)<br>When sync triggers<br>Then updates DB, applies rules (e.g., low stock alert), logs with timestamps.<br>Edge: Manual override by supervisor → audit log.<br>Error: Conflict (e.g., race condition) → rollback, alert admin.                                                                                                                                                                                        |
| UC2.12 | Wave Picking Setup               | As a Supervisor, I want to create picking waves grouped by SLA/cutoff so that priorities are handled first.                                                  | Given orders list<br>When groups into wave (SLA priority, courier cutoff filters)<br>Then assigns wave ID, notifies workers.<br>Edge: Auto-group low-priority.<br>Error: Overlap → "Resolve conflicts."                                                                                                                                                                                                                                                       |
| UC2.13 | Wave Progress Tracking           | As a Worker, I want wave progress visibility so that I track completion in real-time.                                                                        | Given mobile app<br>When joins wave<br>Then shows progress bar (picked/total), alerts on delays.<br>Edge: Partial complete → auto-close.<br>Error: Delay → SLA alert.                                                                                                                                                                                                                                                                                         |
| UC2.14 | Mobile WMS Core                  | As a Worker, I want a dedicated mobile app for picking/packing so that warehouse tasks are optimized for on-the-go use.                                      | Given worker logs in on mobile<br>When accesses QR scan/map<br>Then app uses device camera/GPS for real-time, offline queuing.<br>Edge: Low battery → simplified UI.<br>Error: Offline → sync on reconnect.                                                                                                                                                                                                                                                   |
| UC2.15 | Mobile Staff Onboarding          | As a Supervisor, I want mobile-first staff setup so that new workers can scan QR and start tasks immediately.                                                | Given new worker on app<br>When scans invite QR<br>Then auto-assigns role, loads dashboard.<br>Edge: Web fallback → QR link.<br>Error: Scan fail → manual code entry.                                                                                                                                                                                                                                                                                         |
| UC2.16 | ASN/PO Receiving                 | As a Warehouse Operator, I want to receive purchase orders with ASN processing so that inbound shipments are accurately documented.                          | Given ASN/PO received<br>When operator scans/inputs ASN details (supplier, items, quantities)<br>Then validates against expected receipt, flags variances (over/under/shortages), creates receiving record.<br>Edge: Partial receipt → update existing ASN.<br>Error: ASN not found → manual entry option with escalation for approval.                                                                                                                       |
| UC2.17 | System-Suggested Put-Away        | As a Warehouse Operator, I want automated bin recommendations for storage so that optimal space utilization is achieved.                                     | Given QC-approved items<br>When system analyzes (SKU, dimensions, expiry, demand patterns)<br>Then suggests optimal bin locations with utilization metrics, allows manual override.<br>Edge: Multi-SKU bins → consolidation recommendations.<br>Error: No available bins → alert supervisor for capacity planning.                                                                                                                                            |
| UC2.18 | Cycle Counting & Approvals       | As a Supervisor, I want to perform inventory audits with approval workflows so that accuracy is maintained.                                                  | Given cycle count schedule<br>When operator counts items in assigned bins<br>Then records counts, supervisor reviews variances, approves adjustments.<br>Edge: Automated scheduling → based on ABC analysis.<br>Error: Large variance → escalation to management with photo evidence required.                                                                                                                                                                |
| UC2.19 | Bin Capacity Tracking            | As a Warehouse Manager, I want to monitor bin utilization and capacity so that space planning is data-driven.                                                | Given bin operations<br>When tracks CBM, weight limits, utilization %<br>Then displays capacity dashboards, alerts on over-utilization, optimizes put-away recommendations.<br>Edge: Forecasting → predict capacity needs.<br>Error: Capacity exceeded → block put-away with re-routing.                                                                                                                                                                      |
| UC2.20 | Multi-Warehouse Support          | As a System Admin, I want to configure and manage multiple warehouse facilities so that distributed operations are supported.                                | Given warehouse setup<br>When configures facilities (locations, bins, staff assignments)<br>Then enables cross-warehouse transfers, inventory visibility, unified reporting.<br>Edge: Transfer requests → approval workflows.<br>Error: Duplicate warehouse codes → validation error.                                                                                                                                                                         |

## Wireframes

<img width="2560" height="1846" alt="screen" src="https://github.com/user-attachments/assets/0602dee8-2466-41e9-b1b0-48e0a9f14f65" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/690cdd56-d6fb-40a4-8890-c027b08c7619" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/d1cceceb-3d08-4e1e-977e-538bbf7c7dd2" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/03eef8eb-c63e-4822-9d21-e4ca8e906d35" />
<img width="2560" height="2162" alt="screen" src="https://github.com/user-attachments/assets/1503c98e-9852-440d-b237-468012436f81" />
<img width="2560" height="1768" alt="screen" src="https://github.com/user-attachments/assets/c5c14922-e6d7-47ff-989b-bf97212540ae" />

## Plugin 2.1: Fulfillment Operations

| ID    | Use Case                      | User Story                                                                                                                              | Acceptance Criteria                                                                                                                                                                                                                                                                                       |
| ----- | ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC3.1 | Wave & Batch Picking          | As a Supervisor, I want to create optimized picking waves based on SLA priorities so that fulfillment is efficient and deadline-driven. | Given pending orders<br>When creates wave (SLA priority, carrier cutoff, zone grouping)<br>Then optimizes route planning, assigns to pickers, displays progress dashboard.<br>Edge: Dynamic re-assignment → based on picker availability.<br>Error: No optimal route → fallback to standard picking.      |
| UC3.2 | Scan-to-Pick/Pack Enforcement | As a Picker, I want mandatory barcode scanning for all picking/packing steps so that accuracy is guaranteed.                            | Given assigned wave/order<br>When scans item/location before each action<br>Then validates match, prevents errors, enforces sequence (pick → pack → ship).<br>Edge: Exception handling → supervisor override with audit trail.<br>Error: Mismatch detected → block progress, require correction.          |
| UC3.3 | Picking Route Optimization    | As a System, I want to calculate optimal picking paths to minimize travel time and maximize efficiency.                                 | Given wave assignment<br>When analyzes bin locations, quantities, picker patterns<br>Then generates optimized routes, displays on mobile UI, tracks completion metrics.<br>Edge: Real-time adjustments → based on concurrent picks.<br>Error: Route calculation fails → fallback to alphabetical sorting. |
| UC3.4 | Packing Validation            | As a Packer, I want automated checks during packing to ensure order completeness and accuracy.                                          | Given picked items<br>When scans into packing station<br>Then validates quantities, weights, dimensions against order requirements, flags discrepancies.<br>Edge: Auto-weight calculation → integration with scales.<br>Error: Validation fails → quarantine order for review.                            |
| UC3.5 | Fulfillment Status Tracking   | As a Supervisor, I want real-time visibility into fulfillment progress across all stages.                                               | Given active orders<br>When tracks through stages (assigned → picking → packing → shipping)<br>Then displays live dashboards, bottleneck alerts, performance metrics.<br>Edge: Predictive analytics → estimate completion times.<br>Error: Tracking lag → fallback to manual status updates.              |

## Plugin 3: Logistics Management

| ID     | Use Case                         | User Story                                                                                                                                                  | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ------ | -------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC3.1  | Pickup Scheduling Trigger        | As a Supervisor, I want to trigger a pickup via Torod API when a store submits "Ready for Transfer" so that products are collected from stores efficiently. | Given a "Ready for Transfer" order from store<br>When supervisor triggers (select order, check balance)<br>Then API call to Torod schedules pickup, updates status to "Scheduled", notifies store owner.<br>Edge: Balance sufficient → proceed; low balance → prompt store to top-up.<br>Error: API unresponsive → fallback to manual mode, log error, alert admin.                                                                                |
| UC3.2  | Balance Validation Check         | As a system, I want to validate store balance before pickup trigger so that unpaid requests are blocked.                                                    | Given pickup request initiated<br>When balance checked against required (via base payment integration)<br>Then allows if sufficient, blocks otherwise with notification to store.<br>Edge: Prepay onboarding balance → auto-deduct.<br>Error: Balance API fail → retry logic, fallback to last known balance with warning.                                                                                                                         |
| UC3.3  | Manual Fallback Entry            | As a Supervisor, I want to manually enter pickup details if API fails so that logistics continue without interruption.                                      | Given API failure flagged<br>When supervisor enters manual form (store address, products, date/time)<br>Then saves as manual order, assigns to carrier, notifies parties.<br>Edge: Override validation → allow with admin approval.<br>Error: Duplicate manual entry → de-dupe check "Order already exists."                                                                                                                                       |
| UC3.4  | Logistics Order List & View      | As a Supervisor/Store Owner, I want to list and view logistics orders with search/filter/sort/export/tracking so that I can monitor shipments efficiently.  | Given user on orders list screen<br>When searching (e.g., by order ID/store), filtering (e.g., status: Scheduled/In Transit/Delivered), sorting (e.g., by date DESC)<br>Then displays paginated table (ID, store, status badge, tracking link, actions), export (CSV/PDF), real-time tracking updates.<br>Edge: No orders → empty state "No logistics yet - schedule a pickup."<br>Error: Tracking fail → retry button, fallback to static status. |
| UC3.5  | Logistics Order Update/Edit      | As a Supervisor, I want to edit order details (e.g., reschedule, change carrier) so that adjustments can be made for delays.                                | Given order selected from list<br>When edits in modal (update date, carrier dropdown, notes)<br>Then saves, re-triggers API if needed, notifies affected parties.<br>Edge: Status-dependent edits (e.g., can't edit Delivered).<br>Error: Invalid change (e.g., past date) → inline error; conflict → "Order updated by another - refresh."                                                                                                        |
| UC3.6  | Logistics Order Delete/Cancel    | As a Supervisor, I want to cancel orders (single or bulk) so that unnecessary pickups are stopped.                                                          | Given order(s) selected<br>When cancels (confirm modal with reason)<br>Then updates status to Canceled, refunds balance if deducted, logs.<br>Edge: Bulk cancel → checkboxes, confirm count.<br>Error: In-progress order → block "Cannot cancel - contact carrier."                                                                                                                                                                                |
| UC3.7  | Bulk Pickup Scheduling           | As a Supervisor, I want to bulk schedule pickups for multiple stores so that enterprise-scale operations are efficient.                                     | Given bulk screen (e.g., select multiple "Ready" orders or CSV upload)<br>When submits batch (with balance checks)<br>Then triggers API for each, shows progress/report (e.g., "X scheduled, Y failed").<br>Edge: Partial success → error list per order.<br>Error: Batch too large → throttle "Limit 50 - split batches."                                                                                                                         |
| UC3.8  | Auto-Routing & Carrier Selection | As a system, I want to auto-route shipments to optimal carriers (e.g., Torod default, fallbacks) based on rules so that cost and latency are minimized.     | Given order ready for routing<br>When auto-routes (rules: distance, cost, availability)<br>Then assigns carrier, generates label, updates tracking.<br>Edge: Manual override → supervisor selects from dropdown.<br>Error: No carriers available → alert "Add integrations," fallback manual.                                                                                                                                                      |
| UC3.9  | Label Generation & Printing      | As a Supervisor, I want to generate and print shipping labels so that packages are prepared for carriers.                                                   | Given routed order<br>When generates label (button on order view)<br>Then creates PDF (with barcode, addresses, tracking #), offers print/download.<br>Edge: Custom formats per carrier.<br>Error: Generation fail → retry, log "API error."                                                                                                                                                                                                       |
| UC3.10 | Real-Time Tracking Updates       | As a Store Owner/Supervisor, I want real-time tracking for shipments so that status is visible without manual checks.                                       | Given order in view/list<br>When updates from carrier API (e.g., In Transit → Delivered)<br>Then refreshes UI (websocket), notifies users, logs history.<br>Edge: Timeline view → steps (Scheduled > Picked > Delivered).<br>Error: API delay → "Tracking delayed - check later" banner.                                                                                                                                                           |
| UC3.11 | System Integration & Fallback    | As a system, I want to integrate with Torod/carriers for automation with fallbacks so that reliability is ensured.                                          | Given API call (pickup/route/track)<br>When succeeds → processes; fails → switches to manual, retries queue.<br>Edge: Configurable retries (e.g., 3 attempts).<br>Error: Persistent fail → admin alert, log details.                                                                                                                                                                                                                               |
| UC3.12 | Tag Creation & Assignment        | As a Supervisor, I want to assign structured tags (Fragile/COD) to orders so that handling rules apply.                                                     | Given order edit<br>When adds tags (dropdown: Fragile/Hazmat)<br>Then auto-applies workflows (e.g., special packing).<br>Edge: Bulk tag.<br>Error: Invalid tag → "Not applicable."                                                                                                                                                                                                                                                                 |
| UC3.13 | Rule-Driven Workflows            | As a System, I want rules for tags (e.g., Hazmat: restricted carriers) so that compliance is automated.                                                     | Given tagged order<br>When processes<br>Then enforces (e.g., route to safe carrier).<br>Edge: Configurable rules.<br>Error: Rule conflict → alert.                                                                                                                                                                                                                                                                                                 |
| UC3.14 | Tag Visibility in Apps           | As a Worker, I want tag visibility in mobile apps so that handling is informed.                                                                             | Given picking screen<br>When loads tagged order<br>Then highlights tags with icons/tooltips.<br>Edge: Audio alerts for Fragile.<br>Error: Hidden tag → log exposure.                                                                                                                                                                                                                                                                               |
| UC3.15 | Tags List & Management           | As an Admin, I want tag management with search/export so that tags are governed.                                                                            | Given tags screen<br>When creates/edits<br>Then lists with rules preview.<br>Edge: Export mappings.<br>Error: Duplicate tag → merge.                                                                                                                                                                                                                                                                                                               |

## Wireframes

<img width="2560" height="1786" alt="screen" src="https://github.com/user-attachments/assets/bd0bfbec-4e5b-48f9-b111-e3581a5a1e12" />
<img width="2560" height="2488" alt="screen" src="https://github.com/user-attachments/assets/f65b7a55-d7f2-4104-a9c9-edae03104f08" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/18c3a8c6-f950-4229-8dd0-e8239c7f930e" />
<img width="2560" height="2952" alt="screen" src="https://github.com/user-attachments/assets/be9d8439-5da0-4805-bda0-29f9d36249c4" />
<img width="2560" height="2952" alt="screen" src="https://github.com/user-attachments/assets/f7521412-457f-4ad5-94a2-ea20aab8e41a" />
<img width="2560" height="2398" alt="screen" src="https://github.com/user-attachments/assets/a319065b-b9c1-4826-bd71-a274b9c532cc" />
<img width="2560" height="2420" alt="screen" src="https://github.com/user-attachments/assets/6c28e383-8f4d-4b68-9e1e-82913ac5d0e8" />
<img width="2560" height="2292" alt="screen" src="https://github.com/user-attachments/assets/944b38e0-4275-42e2-997a-65e12cf6f782" />

## Plugin 4: Multi-Invoice Generation & Billing

| ID     | Use Case                           | User Story                                                                                                                                                               | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                      |
| ------ | ---------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC5.1  | Multi-Invoice Generation per Order | As an Accountant, I want automated multi-invoice generation (warehouse, store, marketplace, platform copies) on order creation so that parties receive accurate billing. | Given order created (from POS/logistics)<br>When generation triggers<br>Then splits invoice by party (e.g., warehouse: storage fees; store: product cost), generates PDFs, stores copies, notifies parties.<br>Edge: Custom splits → configurable percentages.<br>Error: Split logic fail → manual override modal, log "Recompute required."                                                             |
| UC5.2  | VAT Handling & Categorization      | As an Accountant, I want VAT applied based on store category so that invoices comply with regulations.                                                                   | Given invoice generation<br>When category checked (e.g., Family Product: No VAT; VAT-compliant: 15%)<br>Then applies rate, adds audit trail, tags invoice.<br>Edge: Category change → retroactive re-calc for open invoices.<br>Error: Undetermined category → prompt "Categorize store first" with link.                                                                                                |
| UC5.3  | Invoice List & View                | As an Accountant/Store Owner, I want to list and view invoices with search/filter/sort/export/previews so that I can manage billing efficiently.                         | Given user on invoices list screen<br>When searching (e.g., by order ID/party), filtering (e.g., status: Generated/Paid, VAT type), sorting (e.g., date DESC)<br>Then displays paginated table (ID, order link, parties summary, VAT total, status, actions), export (CSV/PDF), preview button.<br>Edge: Multi-party view → expandable rows for splits.<br>Error: Load fail → retry, fallback to cached. |
| UC5.4  | Invoice Update/Edit                | As an Accountant, I want to edit invoice details (e.g., splits, VAT re-calc) so that corrections can be made for disputes.                                               | Given invoice selected<br>When edits (adjust splits, re-categorize VAT, add notes)<br>Then re-generates, syncs to QuickBooks, notifies parties.<br>Edge: Locked post-payment → view-only.<br>Error: Invalid split (e.g., over 100%) → inline error; concurrent edit → "Refresh changes."                                                                                                                 |
| UC5.5  | Invoice Delete/Void                | As an Accountant, I want to void invoices (single or bulk) so that errors are reversed.                                                                                  | Given invoice(s) selected<br>When voids (confirm modal with reason)<br>Then marks as Voided, reverses splits/inventory if applicable, logs.<br>Edge: Bulk void → checkboxes, confirm count.<br>Error: Paid invoice → block "Cannot void - issue credit note."                                                                                                                                            |
| UC5.6  | Bulk Invoice Generation            | As an Accountant, I want to bulk generate invoices for multiple orders so that periodic billing is efficient.                                                            | Given bulk screen (select orders or by cycle)<br>When generates (auto-split/VAT)<br>Then processes batch, shows report (e.g., "X generated, Y errors").<br>Edge: Cycle-based → auto-run on schedule (e.g., monthly).<br>Error: Batch fail → partial, error list per invoice.                                                                                                                             |
| UC5.7  | Billing Cycles Management          | As an Accountant, I want configurable billing cycles (e.g., weekly/monthly) with automations so that recurring invoices are handled.                                     | Given cycle setup (e.g., Monday/Thursday from Moyasar)<br>When cycle runs<br>Then aggregates orders, generates invoices, deducts from balance.<br>Edge: Custom intervals → calendar picker.<br>Error: Overdue → alert "Process manually."                                                                                                                                                                |
| UC5.8  | Payment Gateway Integration        | As a system, I want integration with Moyasar for invoice payments so that collections are automated.                                                                     | Given invoice generated<br>When payment link sent (via email/portal)<br>Then processes via Moyasar, updates status to Paid, syncs balance.<br>Edge: Partial payment → split remaining.<br>Error: Gateway fail → retry queue, notify "Payment pending."                                                                                                                                                   |
| UC5.9  | QuickBooks Sync                    | As an Accountant, I want to push invoice records to QuickBooks so that accounting is unified.                                                                            | Given invoice ready (generated/paid)<br>When sync triggers (manual or auto)<br>Then pushes to QuickBooks (e.g., as journal entries), reconciles, logs status.<br>Edge: Bulk sync → select date range.<br>Error: Sync fail → retry, alert "Reconcile manually."                                                                                                                                           |
| UC5.10 | Invoice Splitting Logic            | As a system, I want automated splitting based on roles/parties so that multi-party billing is accurate.                                                                  | Given order with parties (warehouse/store/marketplace/platform)<br>When splits<br>Then allocates amounts (e.g., platform: fee %), applies VAT per category, generates copies.<br>Edge: Custom rules → admin-configurable.<br>Error: Misrouting → auto-re-route based on role map.                                                                                                                        |
| UC5.11 | Audit & Compliance Trails          | As an Admin, I want audit logs for invoices (generation, edits, syncs) so that disputes/VAT audits are resolvable.                                                       | Given invoice event (generate/edit/sync)<br>When logs<br>Then stores with timestamps, actors, before/after, exportable for 90 days.<br>Edge: VAT disputes → filter by category.<br>Error: Log fail → alert, fallback local storage.                                                                                                                                                                      |
| UC5.12 | Ad Hoc Activity Config             | As an Accountant, I want configurable ad hoc fees (e.g., extra weight) so that they auto-trigger invoices.                                                               | Given setup screen<br>When defines activity (fee type, trigger rules e.g., weight >10kg)<br>Then auto-adds to invoice on match.<br>Edge: Per-store rates.<br>Error: Rule conflict → validation warning.                                                                                                                                                                                                  |
| UC5.13 | Ad Hoc Invoice Trigger             | As a System, I want auto-triggers for ad hoc billing so that fees integrate with orders.                                                                                 | Given order event (e.g., heavy package)<br>When rule matches<br>Then adds line item, re-generates invoice.<br>Edge: Bulk orders → aggregate fees.<br>Error: Trigger fail → manual flag.                                                                                                                                                                                                                  |

## Wireframes

<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/224e609d-42c6-4d82-87e4-a3b87dfafa43" />
<img width="256<img width="2560" height="1652" alt="screen" src="https://github.com/user-attachments/assets/462bfd0e-599d-45be-8197-39f370e7fcab" />
0" height="2434" alt="screen" src="https://github.com/user-attachments/assets/c6ca4ad8-a75e-47e4-bcb7-93847e6bca59" />
<img width="2560" height="1728" alt="screen" src="https://github.com/user-attachments/assets/e218fe11-19fb-4970-826f-2bb696f689da" />
<img width="2560" height="1722" alt="screen" src="https://github.com/user-attachments/assets/ad99082f-7d9c-4c20-a96b-43b8b58cff77" />

<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/5fafd9c5-4ca1-4e1e-8475-4c9e6744111b" />

## Plugin 4.1: Compliance Tracking

| ID    | Use Case                      | User Story                                                                                                                         | Acceptance Criteria                                                                                                                                                                                                                                                                                    |
| ----- | ----------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| UC5.1 | FEFO (First Expiry First Out) | As a System, I want to enforce FEFO rules for picking so that products are shipped before expiry.                                  | Given picking process<br>When selects items for order<br>Then prioritizes earliest expiry dates, blocks selection of expired items, logs FEFO compliance.<br>Edge: Manual override → supervisor approval with audit trail.<br>Error: Expired item selected → block and alert "FEFO violation."         |
| UC5.2 | Batch & Lot Tracking          | As a Warehouse Manager, I want to track batches and lots for recall management so that affected products can be identified.        | Given product receipt<br>When assigns batch/lot numbers<br>Then tracks through picking/shipping, enables targeted recalls, maintains genealogy.<br>Edge: Auto-generation → based on supplier/date.<br>Error: Duplicate batch → validation error.                                                       |
| UC5.3 | Expiry Management             | As a Supervisor, I want expiry alerts and automated quarantine so that expired products are handled appropriately.                 | Given inventory items<br>When monitors expiry dates<br>Then sends alerts (7/30/90 days), auto-quarantines expired items, prevents picking.<br>Edge: Custom thresholds → configurable per category.<br>Error: Expired item in active order → block fulfillment.                                         |
| UC5.4 | Recall Workflows              | As an Admin, I want automated recall processes for affected batches so that compliance is maintained.                              | Given recall trigger (batch/lot)<br>When identifies affected inventory<br>Then quarantines items, notifies affected parties, generates recall reports, tracks resolution.<br>Edge: Partial recalls → specific SKUs/batches.<br>Error: Recall execution fail → escalation to management.                |
| UC5.5 | QC on Receiving               | As a QC Inspector, I want to inspect received items for damage, expiry, and quality so that only acceptable goods enter inventory. | Given received ASN<br>When inspector performs QC checks (damage assessment, expiry dates, quantity verification)<br>Then records findings, approves/rejects items, updates status.<br>Edge: Photo evidence → upload for dispute resolution.<br>Error: Critical damage → quarantine workflow triggered. |

## Plugin 4.2: Merchant Portal

| ID    | Use Case              | User Story                                                                                 | Acceptance Criteria                                                                                                                                                                                                                                            |
| ----- | --------------------- | ------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC6.1 | Order Visibility      | As a Merchant, I want real-time order tracking so that I can monitor fulfillment progress. | Given active orders<br>When accesses portal<br>Then displays order status, estimated delivery, tracking updates, fulfillment timeline.<br>Edge: Push notifications → order status changes.<br>Error: Portal access fail → email notifications as fallback.     |
| UC6.2 | Inventory Reports     | As a Merchant, I want inventory visibility and reports so that I can manage stock levels.  | Given portal access<br>When views inventory<br>Then displays stock levels, low stock alerts, sales velocity, forecast recommendations.<br>Edge: Export reports → CSV/PDF options.<br>Error: Data sync delay → shows last known with warning.                   |
| UC6.3 | Performance Analytics | As a Merchant, I want performance metrics and KPIs so that I can optimize operations.      | Given portal dashboard<br>When displays analytics<br>Then shows fulfillment rates, on-time delivery, customer satisfaction, cost per order.<br>Edge: Custom date ranges → flexible reporting.<br>Error: Metric calculation fail → displays "Data unavailable." |
| UC6.4 | Billing Dashboard     | As a Merchant, I want billing transparency and history so that I can track costs.          | Given portal access<br>When views billing<br>Then displays current charges, payment history, outstanding invoices, cost breakdowns.<br>Edge: Auto-payment setup → recurring billing.<br>Error: Billing sync fail → shows cached data with refresh option.      |
| UC6.5 | Real-Time Tracking    | As a Merchant, I want live shipment tracking so that customers receive accurate updates.   | Given shipped orders<br>When customer tracks<br>Then displays real-time location, estimated delivery, delivery updates via portal API.<br>Edge: Custom tracking pages → white-label options.<br>Error: Carrier API fail → fallback to manual status updates.   |

## Plugin 5: Marketplace Management

| ID     | Use Case                           | User Story                                                                                                                                                   | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                                  |
| ------ | ---------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC6.1  | Store Listing Sync                 | As a Supervisor, I want to sync store pages to Hungerstation via API so that stores are listed and visible on the marketplace.                               | Given approved store (from store plugin)<br>When sync triggers (manual or auto)<br>Then API pushes store details (name, address, products), updates status to "Listed", notifies owner.<br>Edge: Partial sync (e.g., new products) → queue for batch.<br>Error: API fail → retry queue (3 attempts), fallback manual.                                                                                                |
| UC6.2  | Product Listing Sync               | As a Supervisor, I want to sync products to marketplace listings (e.g., Hungerstation/Amazon) so that inventory is reflected accurately.                     | Given approved products (from product plugin)<br>When sync runs (real-time or scheduled)<br>Then pushes details (name, price, images, stock via API), handles SKU mapping.<br>Edge: Multi-marketplace → select targets (Hungerstation/Amazon).<br>Error: Stock mismatch → alert "Resolve inventory first."                                                                                                           |
| UC6.3  | Marketplace Listing List & View    | As a Supervisor/Store Owner, I want to list and view listings with search/filter/sort/export/status so that I can manage multi-channel presence efficiently. | Given user on listings screen<br>When searching (e.g., by store/product), filtering (e.g., marketplace: Hungerstation/Amazon, status: Active/Syncing), sorting (e.g., by last sync DESC)<br>Then displays paginated table (Store/Product Name, Marketplace badge, Status, Sync Date, Actions), export (CSV/PDF).<br>Edge: Multi-channel view → grouped by marketplace.<br>Error: Load fail → retry, fallback cached. |
| UC6.4  | Listing Update/Edit                | As a Supervisor, I want to edit listings (e.g., update prices, deactivate) so that changes propagate to marketplaces.                                        | Given listing selected<br>When edits (update details, re-sync button)<br>Then saves, triggers API push, updates status.<br>Edge: Bulk edit → multi-select for common changes.<br>Error: Invalid update (e.g., negative price) → inline error; API reject → "Retry sync."                                                                                                                                             |
| UC6.5  | Listing Delete/Deactivate          | As a Supervisor, I want to deactivate listings (single or bulk) so that outdated items are removed from marketplaces.                                        | Given listing(s) selected<br>When deactivates (confirm modal)<br>Then calls API to delist, updates status to Inactive, logs.<br>Edge: Bulk deactivate → checkboxes, confirm count.<br>Error: Active orders → block "Resolve orders first."                                                                                                                                                                           |
| UC6.6  | Bulk Listing Sync                  | As a Supervisor, I want to bulk sync listings/products to marketplaces so that large catalogs are updated efficiently.                                       | Given bulk screen (select stores/products or full catalog)<br>When syncs (with retry logic)<br>Then processes batch via API, shows report (e.g., "X synced, Y failed").<br>Edge: Scheduled bulk → cron job.<br>Error: Partial fail → error list per item.                                                                                                                                                            |
| UC6.7  | Order Aggregation from Marketplace | As a system, I want to aggregate orders from marketplaces (e.g., Hungerstation/Amazon) so that they are consolidated with POS/logistics without duplicates.  | Given new order from marketplace API<br>When aggregates (match by timestamp/product/customer)<br>Then creates consolidated order, validates lifecycle (Pending), de-dupes.<br>Edge: Multi-source → merge into one record.<br>Error: Duplicate → skip/log "Already processed."                                                                                                                                        |
| UC6.8  | Marketplace Order List & View      | As a Supervisor/Store Owner, I want to list and view aggregated marketplace orders with search/filter/sort/export so that I can process them efficiently.    | Given user on orders screen (marketplace tab)<br>When searching (e.g., by ID/customer), filtering (e.g., marketplace/source, status), sorting (e.g., by date)<br>Then displays table (ID, Marketplace badge, Customer, Items, Status, Actions), export.<br>Edge: Consolidated → source indicators.<br>Error: Sync delay → warning banner.                                                                            |
| UC6.9  | Manual Order Entry Fallback        | As a Supervisor, I want to manually enter marketplace orders if API fails so that fulfillment continues.                                                     | Given API failure<br>When enters form (customer details, products, marketplace source)<br>Then saves as manual, aggregates if matching, notifies.<br>Edge: Tie to existing listing → auto-populate products.<br>Error: Invalid data → validation "Complete all fields."                                                                                                                                              |
| UC6.10 | Multi-Marketplace API Connector    | As a system, I want connectors for multiple marketplaces (Hungerstation, Amazon) with retries so that syncs are resilient.                                   | Given sync/order pull event<br>When calls API (Hungerstation primary, Amazon fallback)<br>Then handles responses, retries on fail, logs.<br>Edge: Configurable endpoints → admin setup.<br>Error: All fails → manual mode, alert.                                                                                                                                                                                    |
| UC6.11 | Sync & Order Status Management     | As a Supervisor, I want to manage sync/order status (e.g., retry, monitor) so that issues are resolved quickly.                                              | Given status flagged (e.g., Failed Sync)<br>When monitors/retries (dashboard with metrics)<br>Then updates status, re-syncs, exports logs.<br>Edge: Real-time metrics → websocket updates.<br>Error: Persistent issue → escalate to admin.                                                                                                                                                                           |

## Wireframes

<img width="2560" height="2138" alt="screen" src="https://github.com/user-attachments/assets/bf6a7593-8ad7-4846-8147-9b83a1476f06" />
<img width="2560" height="1612" alt="screen" src="https://github.com/user-attachments/assets/4bc9ac42-9292-41e5-9a75-1f78df9fec45" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/590e1b9d-5c16-41a2-b5f0-3818f6d1c358" />
<img width="2560" height="1916" alt="screen" src="https://github.com/user-attachments/assets/753ff07c-8857-459c-bee2-7debe03e39d7" />
<img width="2560" height="1818" alt="screen" src="https://github.com/user-attachments/assets/afc2535f-160f-47cf-93b5-c3dad3d5e2bf" />
<img width="2560" height="2054" alt="screen" src="https://github.com/user-attachments/assets/49b29405-abaf-4127-b599-2bdef014d929" />
<img width="2560" height="3326" alt="screen" src="https://github.com/user-attachments/assets/68320331-b471-418a-9494-433614aa912f" />

## Plugin 6: Payout Handling & Payment

| ID     | Use Case                            | User Story                                                                                                                                                             | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                        |
| ------ | ----------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| UC7.1  | Prepay Balance Top-Up               | As a Store Owner, I want to top up prepay balance via Moyasar so that I can maintain funds for onboarding/deliveries.                                                  | Given Store Owner on top-up screen<br>When amount entered, Moyasar form submitted (card/wallet)<br>Then processes payment, adds to balance, notifies accountant.<br>Edge: Minimum top-up (e.g., 100 SAR) → validation.<br>Error: Transaction rejected → error "Retry?" with log.                                                                                                           |
| UC7.2  | Balance Validation & Enforcement    | As a system, I want to validate and deduct from prepay balance for services (e.g., pickups/invoices) so that unpaid actions are blocked.                               | Given service request (e.g., pickup from logistics)<br>When balance checked/deducted<br>Then allows if sufficient, blocks/prompts top-up otherwise.<br>Edge: Auto-deduct for cycles → batch process.<br>Error: Insufficient → notify "Top up required," log.                                                                                                                               |
| UC7.3  | Transaction List & View             | As an Accountant/Store Owner, I want to list and view transactions (payments/payouts) with search/filter/sort/export/history so that I can track finances efficiently. | Given user on transactions screen<br>When searching (e.g., by ID/store), filtering (e.g., type: Payment/Payout, status: Pending/Completed), sorting (e.g., date DESC)<br>Then displays paginated table (ID, Type badge, Amount, Store, Status, Date, Actions), export (CSV/PDF), history modal.<br>Edge: Consolidated view → group by cycle.<br>Error: Load fail → retry, fallback cached. |
| UC7.4  | Transaction Update/Edit             | As an Accountant, I want to edit transaction details (e.g., adjust amount, status) so that corrections can be made for errors.                                         | Given transaction selected<br>When edits (amount, notes, status transition)<br>Then saves, re-syncs Moyasar if needed, notifies parties.<br>Edge: Post-completion → view-only.<br>Error: Invalid amount → inline "Positive value"; concurrent → "Refresh."                                                                                                                                 |
| UC7.5  | Transaction Delete/Void             | As an Accountant, I want to void transactions (single or bulk) so that invalid payments are reversed.                                                                  | Given transaction(s) selected<br>When voids (confirm modal with reason)<br>Then marks as Voided, refunds via Moyasar, updates balance, logs.<br>Edge: Bulk void → checkboxes, confirm count.<br>Error: Completed payout → block "Cannot void - issue reversal."                                                                                                                            |
| UC7.6  | Bulk Payout Processing              | As an Accountant, I want to bulk process payouts (e.g., for multiple stores) so that cycles are handled efficiently.                                                   | Given bulk screen (select stores/transactions or by cycle)<br>When processes (via Moyasar, multi-bank)<br>Then batches API calls, shows report (e.g., "X paid, Y failed").<br>Edge: Partial success → error list per store.<br>Error: Batch fail → rollback partial, alert.                                                                                                                |
| UC7.7  | Payout Cycle Management             | As an Accountant, I want configurable payout cycles (e.g., Monday/Thursday) with automations so that scheduled disbursements are reliable.                             | Given cycle setup (e.g., via Moyasar schedule)<br>When cycle runs<br>Then aggregates eligible transactions, processes payouts (Al Rajhi/SNB/STC Pay), deducts fees.<br>Edge: Custom banks → dropdown per store.<br>Error: Overdue → manual run option.                                                                                                                                     |
| UC7.8  | Moyasar Payment Gateway Integration | As a system, I want integration with Moyasar for top-ups/payouts so that transactions are secure and automated.                                                        | Given payment/payout initiated<br>When calls Moyasar API (e.g., for Al Rajhi transfer)<br>Then processes, updates status/balance, handles callbacks.<br>Edge: Multi-method (STC Pay fallback) → user select.<br>Error: API fail → retry queue (3x), notify "Pending review."                                                                                                               |
| UC7.9  | Multi-Bank Payout Support           | As an Accountant, I want to support multiple banks (Al Rajhi, SNB, STC Pay) for payouts so that stores receive funds flexibly.                                         | Given payout setup<br>When selects bank (per store config)<br>Then routes via Moyasar to bank, confirms transfer.<br>Edge: Bulk with mixed banks → group by type.<br>Error: Bank unavailable → fallback "Choose alternative."                                                                                                                                                              |
| UC7.10 | Balance History & Reporting         | As a Store Owner, I want to view balance history and reports so that I can track prepay usage.                                                                         | Given history screen<br>When views (charts: inflows/outflows, filters by date/type)<br>Then displays timeline, exportable reports.<br>Edge: Projected balance → simple forecast.<br>Error: Data gap → warning "Sync incomplete."                                                                                                                                                           |
| UC7.11 | Audit & Compliance for Transactions | As an Admin, I want audit logs for payments/payouts (triggers, edits, syncs) so that financial audits are supported.                                                   | Given transaction event<br>When logs<br>Then stores with timestamps, actors, before/after, exportable for compliance.<br>Edge: Cycle audits → filter by run.<br>Error: Log fail → alert, local backup.                                                                                                                                                                                     |

## Wireframes

<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/a4ff4665-3ba5-4ea7-8753-793517ffe2fe" />
<img width="2560" height="2110" alt="screen" src="https://github.com/user-attachments/assets/e544e886-ea3f-45eb-93f1-ebddeddf9ba4" />
<img width="2560" height="2112" alt="screen" src="https://github.com/user-attachments/assets/7163890e-9b70-470a-86be-b062bc60dfad" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/e81bae80-4eb0-4e52-a9ba-e6e331456b4e" />
<img width="2530" height="3780" alt="screen" src="https://github.com/user-attachments/assets/54b900cd-cd98-4383-8ae2-9649d27fa610" />
<img width="2560" height="1996" alt="screen" src="https://github.com/user-attachments/assets/070ea162-e679-44e6-b1b3-35ea4bf44e32" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/e6f6e4d0-fec9-44df-96e8-56d4fe1e61ae" />

## Plugin 7: Returns & Refunds Management

| ID    | Use Case             | User Story                                                                                           | Acceptance Criteria                                                                                                                                                                                                                                                      |
| ----- | -------------------- | ---------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| UC8.1 | RMA Creation         | As a Seller, I want to create an RMA for a returned order so that returns are tracked and processed. | Given returned order<br>When seller submits RMA (reason dropdown, photos upload)<br>Then generates RMA ID, updates order status to Returned, notifies warehouse.<br>Edge: Partial return → adjust quantities.<br>Error: Invalid order → "Order not eligible for return." |
| UC8.2 | Return Authorization | As a Staff, I want to authorize returns with inspection so that valid returns are approved.          | Given RMA submitted<br>When staff reviews (modal with photos, condition check)<br>Then approves/rejects, triggers restock/refund.<br>Edge: Auto-approve low-value.<br>Error: Inspection fail → reject with reason email.                                                 |
| UC8.3 | Restock to Inventory | As a System, I want to restock returned items to inventory so that stock levels are accurate.        | Given approved return<br>When restock triggers<br>Then adds back to shelf/SKU, syncs availability.<br>Edge: Condition downgrade → partial stock.<br>Error: Shelf full → queue for reassignment.                                                                          |
| UC8.4 | Refund Processing    | As a Seller, I want to issue refunds via Moyasar so that customers are reimbursed.                   | Given authorized RMA<br>When refund initiated (amount calc from order)<br>Then processes via gateway, updates balance.<br>Edge: Partial refund → split.<br>Error: Gateway fail → retry queue.                                                                            |
| UC8.5 | Returns List & View  | As a Seller/Staff, I want to list/view RMAs with search/filter/export so that returns are managed.   | Given returns screen<br>When filtering (status/date)<br>Then table shows ID, order link, status, refund amount.<br>Edge: Export CSV with details.<br>Error: Load fail → retry.                                                                                           |

## Plugin 8: Audit & Logging

| ID     | Use Case              | User Story                                                                                   | Acceptance Criteria                                                                                                                                                        |
| ------ | --------------------- | -------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| UC10.1 | Transaction Logging   | As a System, I want to log all transactions (orders/payments) so that audits are traceable.  | Given event (e.g., order update)<br>When logs<br>Then stores actor/timestamp/before-after.<br>Edge: Retention 90 days auto-purge.<br>Error: Log fail → alert, local store. |
| UC10.2 | API Logging & Metrics | As an Admin, I want API logs/metrics (e.g., sync errors) so that integrations are monitored. | Given logs screen<br>When filters (API endpoint/date)<br>Then table with calls/status, export CSV.<br>Edge: Alerts on high errors.<br>Error: No logs → "Quiet period."     |
| UC10.3 | Audit Report Export   | As an Admin, I want to export audit logs for compliance so that reviews are easy.            | Given export button<br>When selects range<br>Then generates SIEM-compatible file.<br>Edge: Filter by user/event type.<br>Error: Large export → chunked download.           |

## Wireframes

<img width="2560" height="2008" alt="screen" src="https://github.com/user-attachments/assets/bbdbf723-277f-4f1c-b2a3-e137fb632cd6" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/176717c4-431a-4c0f-80ac-572ea78aa8af" />

<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/c9405db5-13b1-4a3a-8ca6-b0b433f7dc23" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/873c526a-be47-41a6-abf9-6796a4339771" />
<img width="2560" height="1600" alt="screen" src="https://github.com/user-attachments/assets/cbda77e1-35ba-4895-9c5f-5a119ecbf092" />

## Plugin 9: SLAs Enforcement & Monitoring

Focus: Sync SLA enforcement (<30s) with alerts/compensation; real-time monitoring beyond basic errors.

| ID     | Use Case                   | User Story                                                                                       | Acceptance Criteria                                                                                                                                                |
| ------ | -------------------------- | ------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| UC13.1 | SLA Monitoring Setup       | As an Admin, I want SLA thresholds (e.g., <30s sync) so that performance is tracked.             | Given setup<br>When defines (sync/order SLAs)<br>Then monitors via metrics, alerts on breach.<br>Edge: Custom per workflow.<br>Error: Metric fail → fallback calc. |
| UC13.2 | SLA Alerts & Notifications | As a System, I want alerts on SLA misses so that issues are resolved.                            | Given breach (e.g., sync >30s)<br>Then sends push/email, logs.<br>Edge: Escalation tiers.<br>Error: Alert loop → throttle.                                         |
| UC13.3 | SLA Compensation Workflow  | As an Admin, I want auto-compensation (e.g., fee waiver) on misses so that SLAs are enforceable. | Given breach confirmed<br>When triggers<br>Then applies credit to invoice, notifies.<br>Edge: Threshold % for waiver.<br>Error: No balance → queue.                |
| UC13.4 | SLA Dashboard              | As an Admin, I want SLA reports so that compliance is visualized.                                | Given dashboard<br>When views (charts: on-time %)<br>Then exports data.<br>Edge: Filter by service.<br>Error: Data gap → warning.                                  |

## Non-Functional Requirements

The platform ensures high performance, reliability, security, and compliance across the base app and all plugins (e.g., store management, warehouse operations, logistics routing, POS sync, billing splits, marketplace listings, payouts, returns, reporting, audits, and localization). Targets are verified via acceptance criteria, with enforcement through monitoring, SLAs, and fallbacks.

| Requirement                 | Target Specification                                                        | Acceptance Criteria                                                                                        |
| --------------------------- | --------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| **Performance**             | <1s load time on main flows (e.g., order sync, listing updates)             | 90% of traffic completes actions in under 1s; real-time validations (e.g., stock checks) <500ms            |
| **Availability**            | 99.5% uptime across integrations (e.g., APIs for POS/billing)               | Downtime <2 hrs per month; automated retries for carrier/marketplace syncs                                 |
| **Scalability**             | Horizontally scalable edge functions                                        | Supports 1,000+ active stores, 10,000+ SKUs/items; handles bulk ops (e.g., 500+ payouts/cycles)            |
| **Mobile Readiness**        | Web + app parity for all roles (e.g., worker QR scanning, supervisor waves) | Shared codebase with responsive/RTL layout; offline queuing in warehouse/POS plugins                       |
| **Legal Compliance**        | VAT rules, KSA/GCC food/regional regulations                                | Contracts/invoices reflect compliance; audit trails for tags/transfers (90-day retention)                  |
| **Security**                | Strict multi-tenant isolation (RLS/endpoint hardening)                      | Role scoping blocks cross-tenant access; logs violations with alerts; secure API keys/OAuth for connectors |
| **Integration Reliability** | <30s SLA for syncs (e.g., marketplace kits, carrier city mapping)           | Enforcement with alerts/compensation (e.g., fee waivers); fallbacks for inbound QC/ad hoc billing          |
| **Accessibility**           | WCAG 2.1 AA compliance (e.g., tag visibility, multi-lang)                   | Screen reader support for reports/audits; keyboard nav in mobile WMS; i18n for EN/AR with Hijri dates      |
| **Data Integrity**          | No duplicates/race conditions (e.g., stock transfers, wave picking)         | Real-time locks/validation; de-dup logic for aggregated orders/returns; BOM sync for kit                   |

## 100-Day Implementation Timeline

The platform will be built across **5 major phases** using **2-week sprints** (10 sprints total). Each sprint delivers incremental, testable functionality with continuous integration across base system and plugins.

### **Phase 1: Foundation & Core Infrastructure (Days 1-20, Sprints 1-2)**

**Sprint 1 (Days 1-10): Base System Setup**

- **Goals**: Infrastructure, authentication, basic RBAC
- **Deliverables**:
  - Project scaffolding (Next.js/React frontend, PostgreSQL DB)
  - Landing page (UC1.1: responsive design, hero/features/CTA)
  - Authentication flows (UC2.1-2.6: signup with OTP, login, password recovery)
  - Basic user profile management (UC6.1)
  - CI/CD pipeline setup
- **Testing**: E2E tests for signup/login flows
- **Acceptance**: Users can register, verify OTP, complete profile, and await approval

**Sprint 2 (Days 11-20): RBAC & Admin Foundation**

- **Goals**: Complete authorization, admin tools, basic analytics
- **Deliverables**:
  - RBAC implementation (UC3.1-3.7: role creation, permissions matrix, assignments, tenant isolation)
  - Admin dashboard (UC7.1-7.2: user approval queue, role management UI)
  - Basic analytics (UC4.1-4.2: KPI cards, system logs)
  - Error pages & logout (UC8.1-8.2)
  - Payment gateway integration (UC5.1-5.2: Moyasar setup for top-ups/payouts)
- **Testing**: RBAC permission tests, tenant isolation validation
- **Acceptance**: Admins can approve users, assign roles with scoped permissions; users see role-based dashboards

---

### **Phase 2: Store & Product Management + Warehouse Core (Days 21-40, Sprints 3-4)**

**Sprint 3 (Days 21-30): Store & Product Plugin**

- **Goals**: Store onboarding, product CRUD, approval workflows
- **Deliverables**:
  - Store registration (UC1.1-1.2: form with validations, admin approval workflow)
  - Product management (UC1.3-1.7: create/upload, approval, list/view, update, delete)
  - Bulk product upload (UC1.8: CSV import with validation/report)
  - Inventory views (UC1.9: dashboard with stock levels, sync to inventory queue)
  - System inventory sync (UC1.10: background jobs for SKU mapping, low stock alerts)
- **Testing**: Product approval workflows, bulk import edge cases
- **Acceptance**: Store owners can register, submit products for approval; inventory syncs to warehouse queue

**Sprint 4 (Days 31-40): Warehouse Management Core**

- **Goals**: Staff management, shelf assignments, picking/packing foundation
- **Deliverables**:
  - Staff CRUD (UC2.1-2.5: add/edit/delete supervisors/workers, bulk import)
  - Shelf assignment (UC2.6: manual/auto-suggest for arrivals with QR mapping setup)
  - QR mapping UI (UC2.7: mobile-ready map for store/pick with scan integration)
  - Inventory management list (UC2.8: live views with search/filter/export)
  - Warehouse order creation (UC2.9: generate orders from arrivals)
  - Basic picking/packing (UC2.10: QR validation workflow for workers)
- **Testing**: Staff role constraints, QR scan accuracy, shelf capacity checks
- **Acceptance**: Supervisors can assign shelves; workers can pick/pack using QR codes; inventory updates in real-time

---

### **Phase 3: Logistics & Billing Infrastructure (Days 41-60, Sprints 5-6)**

**Sprint 5 (Days 41-50): Logistics Management Plugin**

- **Goals**: Pickup scheduling, routing, tracking integration
- **Deliverables**:
  - Pickup scheduling (UC3.1-3.3: Torod API integration, balance validation, manual fallback)
  - Logistics order CRUD (UC3.4-3.6: list/view/update/delete with tracking)
  - Bulk pickup scheduling (UC3.7: batch operations with progress reports)
  - Auto-routing & carrier selection (UC3.8: rules-based routing, fallbacks)
  - Label generation (UC3.9: PDF with barcodes, print/download)
  - Real-time tracking (UC3.10: API sync with carrier status updates)
  - Tag management (UC3.12-3.15: structured tags, rule-driven workflows, mobile visibility)
- **Testing**: API retry logic, balance checks, manual fallback flows
- **Acceptance**: Supervisors can schedule pickups via Torod API; orders track from Scheduled → Delivered; manual entry works on API fail

**Sprint 6 (Days 51-60): Multi-Invoice & Billing Plugin**

- **Goals**: Invoice generation, VAT handling, QuickBooks sync
- **Deliverables**:
  - Multi-invoice generation (UC5.1: per-order splits for warehouse/store/marketplace/platform)
  - VAT handling (UC5.2: category-based rates, compliance tagging)
  - Invoice CRUD (UC5.3-5.5: list/view/edit/void with party splits)
  - Bulk invoice generation (UC5.6: batch processing with cycle support)
  - Billing cycles (UC5.7: configurable schedules, automations)
  - Moyasar integration (UC5.8: payment links, status updates)
  - QuickBooks sync (UC5.9: journal entry push, reconciliation)
  - Ad hoc billing (UC5.12-5.13: configurable fees, auto-triggers)
- **Testing**: Split logic accuracy, VAT calculations, QuickBooks sync retries
- **Acceptance**: Accountants can generate multi-party invoices with correct VAT; cycles auto-run; syncs to QuickBooks

---

### **Phase 4: Marketplace & Payouts + Advanced Features (Days 61-80, Sprints 7-8)**

**Sprint 7 (Days 61-70): Marketplace Management Plugin**

- **Goals**: Multi-channel listings, order aggregation, de-duplication
- **Deliverables**:
  - Store & product listing sync (UC6.1-6.2: API push to Hungerstation/Amazon with SKU mapping)
  - Listing CRUD (UC6.3-6.5: list/view/edit/deactivate with multi-marketplace support)
  - Bulk listing sync (UC6.6: batch operations with retry/report)
  - Order aggregation (UC6.7: consolidate orders from marketplaces, de-dupe logic)
  - Marketplace order management (UC6.8-6.9: list/view, manual entry fallback)
  - Multi-marketplace connectors (UC6.10: Hungerstation primary, Amazon fallback)
  - Sync status management (UC6.11: monitoring dashboard, retry mechanisms)
- **Testing**: De-dupe logic, multi-API failover, order consolidation
- **Acceptance**: Listings sync to Hungerstation/Amazon; orders aggregate without duplicates; manual entry works on API fail

**Sprint 8 (Days 71-80): Payout Handling & Payment Plugin + Wave Picking**

- **Goals**: Payout cycles, multi-bank support, warehouse wave picking
- **Deliverables**:
  - Prepay balance top-up (UC7.1: Moyasar integration with validation)
  - Balance validation/enforcement (UC7.2: service blocking on insufficient funds)
  - Transaction CRUD (UC7.3-7.5: list/view/edit/void with history)
  - Bulk payout processing (UC7.6: batch operations via Moyasar)
  - Payout cycles (UC7.7: Monday/Thursday schedules, multi-bank routing)
  - Multi-bank support (UC7.9: Al Rajhi/SNB/STC Pay via Moyasar)
  - Balance history & reporting (UC7.10: charts, exports, forecasts)
  - Transaction audits (UC7.11: compliance logs with retention)
  - Wave picking setup (UC2.12: SLA/cutoff grouping)
  - Wave progress tracking (UC2.13: real-time mobile updates)
  - Mobile WMS core (UC2.14-2.15: optimized app, QR onboarding)
- **Testing**: Payout cycle accuracy, multi-bank routing, wave SLA enforcement
- **Acceptance**: Stores can top-up balance; accountants process bulk payouts to multiple banks; workers use wave picking on mobile

---

### **Phase 5: Returns, Audits, SLAs & Polish (Days 81-100, Sprints 9-10)**

**Sprint 9 (Days 81-90): Returns, Refunds & Audit/Logging Plugins**

- **Goals**: Returns workflows, comprehensive audit trails
- **Deliverables**:
  - RMA creation & authorization (UC8.1-8.2: return requests with inspection/approval)
  - Restock to inventory (UC8.3: shelf re-assignment, sync to stock)
  - Refund processing (UC8.4: Moyasar refunds with balance updates)
  - Returns list & management (UC8.5: search/filter/export for RMAs)
  - Transaction logging (UC10.1: all order/payment events with actor/timestamp)
  - API logging & metrics (UC10.2: integration monitoring with alerts)
  - Audit report export (UC10.3: SIEM-compatible exports for compliance)
  - System inventory sync (UC2.11: real-time movement tracking with conflict resolution)
- **Testing**: Restock accuracy, refund flows, audit log retention
- **Acceptance**: Sellers can create RMAs; staff approve/restock; refunds process via Moyasar; full audit trails exportable

**Sprint 10 (Days 91-100): SLA Enforcement, Monitoring & Final Integration**

- **Goals**: SLA enforcement, monitoring dashboards, system-wide testing
- **Deliverables**:
  - SLA monitoring setup (UC13.1: thresholds for sync/order **workflows**)
  - SLA alerts & notifications (UC13.2: breach alerts with escalation)
  - SLA compensation workflow (UC13.3: auto-credits on misses)
  - SLA dashboard (UC13.4: compliance reports with visualizations)
  - Marketplace wireframe features integration (product lists, order details from wireframes)
  - Warehouse wireframe features integration (QR maps, staff management from wireframes)
  - System-wide integration testing (end-to-end: store signup → product upload → warehouse picking → logistics delivery → invoice generation → payout)
  - Security audit (tenant isolation, API key rotation)
  - Documentation & training materials
- **Testing**: Full regression, load testing (1,000 stores/10,000 SKUs), SLA enforcement validation
- **Acceptance**: All plugins integrate seamlessly; SLAs monitored with auto-compensation; system handles target load; documentation complete

---

## Technical Approach

Extend existing architecture with new domain modules:

- **warehouse_core**: ASN, bin logic, capacity tracking, cycle counting
- **fulfillment_ops**: picking, packing, transfers, wave management
- **compliance_track**: FEFO, batch, recall workflows, expiry management
- **merchant_portal**: visibility, reports, analytics dashboards
- **billing_engine_v2**: fees, reconciliation, multi-warehouse invoicing

---

### **Risk Mitigation**

- **API Integration Risks**: Comprehensive fallback processes for all external APIs (Shopify, carriers, payment gateways)
- **Scope Management**: Phased delivery with clear acceptance criteria for each module
- **Performance Requirements**: Continuous monitoring and optimization throughout development
- **Compliance Gaps**: Built-in validation and audit trails from day one
- **Team Coordination**: Weekly reviews and iterative testing to ensure module integration

## Price

78k SAR
